<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>tomato_harvester: robot.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">robot.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="robot_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="robot_8h.html">robot.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#pragma region RobotInitializer</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#pragma region public methods</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#abd7b91acbc62b21d4c316dc948cb80bf">   13</a></span>&#160;<a class="code" href="classRobotInitializer.html#abd7b91acbc62b21d4c316dc948cb80bf">RobotInitializer::RobotInitializer</a>(<span class="keyword">const</span> std::string &amp;name, <span class="keyword">const</span> BT::NodeConfiguration &amp;config) : BT::SyncActionNode(name, config)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="ros__logs_8h.html#a4a4256ba66bee01b1b57fb080b148260">ROS_LOG_INIT</a>(this-&gt;name().c_str());</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#a1456920412f9c402045583e3847a684e">   23</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classRobotInitializer.html#a30c428fcc19ac0cf1b0373196d8fb352">RobotInitializer::init</a>(<a class="code" href="classManipulator.html">Manipulator</a> manipulator)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classRobotInitializer.html#a3785f94a58e9e48941ef1068af2018ec">manipulator_</a> = manipulator;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#a30c428fcc19ac0cf1b0373196d8fb352">   33</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classRobotInitializer.html#a30c428fcc19ac0cf1b0373196d8fb352">RobotInitializer::init</a>(ros::NodeHandle node_handle)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classRobotInitializer.html#af7a3a526602bc1f95e55fecb8af31231">node_handle_</a> = node_handle;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#a4f74df86594389fa8b8c2f976e950a30">   43</a></span>&#160;BT::NodeStatus <a class="code" href="classRobotInitializer.html#a4f74df86594389fa8b8c2f976e950a30">RobotInitializer::tick</a>()</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    moveit::core::MoveItErrorCode code = <a class="code" href="classRobotInitializer.html#a8426cd7e0bfae3788f0065a6c071ee22">SetInitialPosition</a>();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classRobotInitializer.html#ac285c050416af9a604ba00b689fc550f">LaunchBasket</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">return</span> BT::NodeStatus::SUCCESS;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#a0e969f325196c09803529cb84d73f546">   55</a></span>&#160;BT::PortsList <a class="code" href="classRobotInitializer.html#a0e969f325196c09803529cb84d73f546">RobotInitializer::providedPorts</a>()</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span> {BT::InputPort&lt;std::string&gt;(<span class="stringliteral">&quot;message&quot;</span>)};</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#pragma region private methods</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#a8426cd7e0bfae3788f0065a6c071ee22">   69</a></span>&#160;moveit::core::MoveItErrorCode <a class="code" href="classRobotInitializer.html#a8426cd7e0bfae3788f0065a6c071ee22">RobotInitializer::SetInitialPosition</a>()</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    moveit::core::MoveItErrorCode code = <a class="code" href="classRobotInitializer.html#a3785f94a58e9e48941ef1068af2018ec">manipulator_</a>.<a class="code" href="classManipulator.html#aae4ece9fb73dde49f9b1f39dc23d739c">MoveToInitialPosition</a>();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span> code;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classRobotInitializer.html#ac285c050416af9a604ba00b689fc550f">   79</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classRobotInitializer.html#ac285c050416af9a604ba00b689fc550f">RobotInitializer::LaunchBasket</a>()</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    ROS_INFO(<span class="stringliteral">&quot;Service &#39;/gazebo/spawn_urdf_model&#39; is about to get called.&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">bool</span> connected = ros::service::waitForService(<span class="stringliteral">&quot;/gazebo/spawn_urdf_model&quot;</span>, 10);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    ROS_INFO(<span class="stringliteral">&quot;Service received&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">char</span> modelname[20];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">char</span> linkname[30];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    std::srand(std::time(NULL));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> model_id = std::rand() % 1000;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    sprintf(modelname, <span class="stringliteral">&quot;basket_%d&quot;</span>, model_id);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    sprintf(linkname, <span class="stringliteral">&quot;tomato_basket_link_%d&quot;</span>, model_id);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    ros::ServiceClient spawn_model_client = <a class="code" href="classRobotInitializer.html#af7a3a526602bc1f95e55fecb8af31231">node_handle_</a>.serviceClient&lt;gazebo_msgs::SpawnModel&gt;(<span class="stringliteral">&quot;/gazebo/spawn_urdf_model&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    gazebo_msgs::SpawnModel spawn_model;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    spawn_model.request.model_name = modelname;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// generate urdf-file from xacro</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    std::string ba22_toff_06_path = ros::package::getPath(<span class="stringliteral">&quot;ba22_toff_06&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    std::string path_to_xacro = ba22_toff_06_path + <span class="stringliteral">&quot;/urdf/basket/basket.urdf.xacro&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    std::string path_to_urdf = ba22_toff_06_path + <span class="stringliteral">&quot;/urdf/basket/basket.urdf&quot;</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    std::string xacro_cmd = <span class="stringliteral">&quot;xacro &quot;</span> + path_to_xacro + <span class="stringliteral">&quot; &gt; &quot;</span> + path_to_urdf + <span class="stringliteral">&quot; basket_link_id:=&quot;</span> + linkname;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::system(xacro_cmd.c_str());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// load urdf file</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    std::string urdf_filename = path_to_urdf;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    ROS_INFO(<span class="stringliteral">&quot;loading file: %s&quot;</span>, urdf_filename.c_str());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// read urdf / gazebo model xml from file</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    TiXmlDocument xml_in(urdf_filename);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    xml_in.LoadFile();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::ostringstream stream;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    stream &lt;&lt; xml_in;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    spawn_model.request.model_xml = stream.str(); <span class="comment">// load xml file</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    spawn_model.request.robot_namespace = <span class="stringliteral">&quot;summit_xl&quot;</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    geometry_msgs::Pose pose;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    spawn_model.request.reference_frame = <span class="stringliteral">&quot;summit_xl_base_footprint&quot;</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    pose.position.x = -0.52;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    pose.position.y = 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    pose.position.z = 0.38;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    pose.orientation = tf::createQuaternionMsgFromRollPitchYaw(0, 0, 0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    spawn_model.request.initial_pose = pose;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">bool</span> spawned = spawn_model_client.call(spawn_model);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    ROS_INFO(<span class="stringliteral">&quot;Service &#39;/link_attacher_node/attach&#39; is about to get called.&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">char</span> system_call[200];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    sprintf(system_call, <span class="stringliteral">&quot;rosservice call /link_attacher_node/attach \&quot;model_name_1: &#39;summit_xl&#39;\nlink_name_1: &#39;summit_xl_base_footprint&#39;\nmodel_name_2: &#39;%s&#39;\nlink_name_2: &#39;%s&#39;\&quot; &quot;</span>, modelname, linkname);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    std::system(system_call);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    ROS_INFO(<span class="stringliteral">&quot;Basket successfully attached!&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#pragma region BatteryCheck</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classBatteryCheck.html#a69d05329d59f5762ba62fdfccc04e7c5">  146</a></span>&#160;<a class="code" href="classBatteryCheck.html#a69d05329d59f5762ba62fdfccc04e7c5">BatteryCheck::BatteryCheck</a>(<span class="keyword">const</span> std::string &amp;name, <span class="keyword">const</span> BT::NodeConfiguration &amp;config) : BT::ConditionNode(name, config)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="ros__logs_8h.html#a4a4256ba66bee01b1b57fb080b148260">ROS_LOG_INIT</a>(this-&gt;name().c_str());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classBatteryCheck.html#a10b5258be2dd5e6a257cd2de18efa71e">battery_empty_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ros::param::get(<span class="stringliteral">&quot;battery_timer&quot;</span>, <a class="code" href="classBatteryCheck.html#a3588baac94dcd4dde42a17d721ae58a5">timer_duration_</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classBatteryCheck.html#aeb790a61988bd040bc11985e1ff2ab78">timer_</a> = <a class="code" href="classBatteryCheck.html#a69b798a1b2c0e61419663c628d3f0e99">node_handle_</a>.createTimer(ros::Duration(<a class="code" href="classBatteryCheck.html#a3588baac94dcd4dde42a17d721ae58a5">timer_duration_</a>), &amp;<a class="code" href="classBatteryCheck.html#ac79a01b11197fe856190109749dec577">BatteryCheck::TimerCallback</a>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classBatteryCheck.html#a99274212a480bfa7314f02c42b5a73c1">start_</a> = ros::Time::now().toSec();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classBatteryCheck.html#a1524baa7279bac051fd722437dcd91c5">  160</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBatteryCheck.html#a1524baa7279bac051fd722437dcd91c5">BatteryCheck::init</a>(ros::NodeHandle node_handle)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classBatteryCheck.html#a69b798a1b2c0e61419663c628d3f0e99">node_handle_</a> = node_handle;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="classBatteryCheck.html#acaf0cdb1c44408c233215317bb95fd51">  170</a></span>&#160;BT::NodeStatus <a class="code" href="classBatteryCheck.html#acaf0cdb1c44408c233215317bb95fd51">BatteryCheck::tick</a>()</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> now = ros::Time::now().toSec();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">double</span> current_battery_level = (90 - (now - <a class="code" href="classBatteryCheck.html#a99274212a480bfa7314f02c42b5a73c1">start_</a>) / <a class="code" href="classBatteryCheck.html#a3588baac94dcd4dde42a17d721ae58a5">timer_duration_</a> * 90) + 10;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBatteryCheck.html#a10b5258be2dd5e6a257cd2de18efa71e">battery_empty_</a>)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="classBatteryCheck.html#a10b5258be2dd5e6a257cd2de18efa71e">battery_empty_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="classBatteryCheck.html#a99274212a480bfa7314f02c42b5a73c1">start_</a> = ros::Time::now().toSec();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (current_battery_level &lt; 3)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            ROS_WARN(<span class="stringliteral">&quot;[MOCKED BEHAVIOR] Battery capacity too low: &lt;3 %%!&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">return</span> BT::NodeStatus::FAILURE;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        ROS_WARN(<span class="stringliteral">&quot;[MOCKED BEHAVIOR] Battery capacity too low: %.2lf %%!&quot;</span>, current_battery_level);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> BT::NodeStatus::FAILURE;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        ROS_INFO(<span class="stringliteral">&quot;[MOCKED BEHAVIOR] Battery capacity ok: %.2lf %%!&quot;</span>, current_battery_level);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">return</span> BT::NodeStatus::SUCCESS;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classBatteryCheck.html#ab42e64f3b8f22906788bdbcaece448e9">  200</a></span>&#160;BT::PortsList <a class="code" href="classBatteryCheck.html#ab42e64f3b8f22906788bdbcaece448e9">BatteryCheck::providedPorts</a>()</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classBatteryCheck.html#ac79a01b11197fe856190109749dec577">  205</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBatteryCheck.html#ac79a01b11197fe856190109749dec577">BatteryCheck::TimerCallback</a>(<span class="keyword">const</span> ros::TimerEvent &amp;timer_event)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;{</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classBatteryCheck.html#a10b5258be2dd5e6a257cd2de18efa71e">battery_empty_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    ROS_WARN(<span class="stringliteral">&quot;Battery capacity from now on too low!&quot;</span>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#pragma region BatteryCharge</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classBatteryCharge.html#a851db75b08a716140c848adc3c2f5545">  221</a></span>&#160;<a class="code" href="classBatteryCharge.html#a851db75b08a716140c848adc3c2f5545">BatteryCharge::BatteryCharge</a>(<span class="keyword">const</span> std::string &amp;name, <span class="keyword">const</span> BT::NodeConfiguration &amp;config) : BT::ConditionNode(name, config)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="ros__logs_8h.html#a4a4256ba66bee01b1b57fb080b148260">ROS_LOG_INIT</a>(this-&gt;name().c_str());</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classBatteryCharge.html#aae67e21b70ee805349acd25ddfbb2c84">  231</a></span>&#160;BT::NodeStatus <a class="code" href="classBatteryCharge.html#aae67e21b70ee805349acd25ddfbb2c84">BatteryCharge::tick</a>()</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    ROS_WARN(<span class="stringliteral">&quot;Mocking behavior of charging:&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= 10; i++)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        ros::Duration(0.5).sleep();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        ROS_INFO(<span class="stringliteral">&quot;Battery capacity: %d %%&quot;</span>, i * 10);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> BT::NodeStatus::SUCCESS;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classBatteryCharge.html#a59df2c3cf502b80b6268e514b50613f3">  248</a></span>&#160;BT::PortsList <a class="code" href="classBatteryCharge.html#a59df2c3cf502b80b6268e514b50613f3">BatteryCharge::providedPorts</a>()</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#pragma endregion</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassBatteryCheck_html_acaf0cdb1c44408c233215317bb95fd51"><div class="ttname"><a href="classBatteryCheck.html#acaf0cdb1c44408c233215317bb95fd51">BatteryCheck::tick</a></div><div class="ttdeci">BT::NodeStatus tick() override</div><div class="ttdoc">Handles the tick from the behavior tree.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00170">robot.cpp:170</a></div></div>
<div class="ttc" id="arobot_8h_html"><div class="ttname"><a href="robot_8h.html">robot.h</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_a3588baac94dcd4dde42a17d721ae58a5"><div class="ttname"><a href="classBatteryCheck.html#a3588baac94dcd4dde42a17d721ae58a5">BatteryCheck::timer_duration_</a></div><div class="ttdeci">float timer_duration_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00067">robot.h:67</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_a8426cd7e0bfae3788f0065a6c071ee22"><div class="ttname"><a href="classRobotInitializer.html#a8426cd7e0bfae3788f0065a6c071ee22">RobotInitializer::SetInitialPosition</a></div><div class="ttdeci">moveit::core::MoveItErrorCode SetInitialPosition()</div><div class="ttdoc">Sets the initial position of the robot.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00069">robot.cpp:69</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_a10b5258be2dd5e6a257cd2de18efa71e"><div class="ttname"><a href="classBatteryCheck.html#a10b5258be2dd5e6a257cd2de18efa71e">BatteryCheck::battery_empty_</a></div><div class="ttdeci">bool battery_empty_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00066">robot.h:66</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_a99274212a480bfa7314f02c42b5a73c1"><div class="ttname"><a href="classBatteryCheck.html#a99274212a480bfa7314f02c42b5a73c1">BatteryCheck::start_</a></div><div class="ttdeci">double start_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00068">robot.h:68</a></div></div>
<div class="ttc" id="aclassBatteryCharge_html_a59df2c3cf502b80b6268e514b50613f3"><div class="ttname"><a href="classBatteryCharge.html#a59df2c3cf502b80b6268e514b50613f3">BatteryCharge::providedPorts</a></div><div class="ttdeci">static BT::PortsList providedPorts()</div><div class="ttdoc">Ports to exchange information between each other.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00248">robot.cpp:248</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_a3785f94a58e9e48941ef1068af2018ec"><div class="ttname"><a href="classRobotInitializer.html#a3785f94a58e9e48941ef1068af2018ec">RobotInitializer::manipulator_</a></div><div class="ttdeci">Manipulator manipulator_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00041">robot.h:41</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_a4f74df86594389fa8b8c2f976e950a30"><div class="ttname"><a href="classRobotInitializer.html#a4f74df86594389fa8b8c2f976e950a30">RobotInitializer::tick</a></div><div class="ttdeci">BT::NodeStatus tick() override</div><div class="ttdoc">Handles the tick from the behavior tree.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00043">robot.cpp:43</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_aeb790a61988bd040bc11985e1ff2ab78"><div class="ttname"><a href="classBatteryCheck.html#aeb790a61988bd040bc11985e1ff2ab78">BatteryCheck::timer_</a></div><div class="ttdeci">ros::Timer timer_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00065">robot.h:65</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_af7a3a526602bc1f95e55fecb8af31231"><div class="ttname"><a href="classRobotInitializer.html#af7a3a526602bc1f95e55fecb8af31231">RobotInitializer::node_handle_</a></div><div class="ttdeci">ros::NodeHandle node_handle_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00042">robot.h:42</a></div></div>
<div class="ttc" id="aclassBatteryCharge_html_aae67e21b70ee805349acd25ddfbb2c84"><div class="ttname"><a href="classBatteryCharge.html#aae67e21b70ee805349acd25ddfbb2c84">BatteryCharge::tick</a></div><div class="ttdeci">BT::NodeStatus tick() override</div><div class="ttdoc">Handles the tick from the behavior tree.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00231">robot.cpp:231</a></div></div>
<div class="ttc" id="aclassManipulator_html_aae4ece9fb73dde49f9b1f39dc23d739c"><div class="ttname"><a href="classManipulator.html#aae4ece9fb73dde49f9b1f39dc23d739c">Manipulator::MoveToInitialPosition</a></div><div class="ttdeci">moveit::core::MoveItErrorCode MoveToInitialPosition(void)</div><div class="ttdoc">Moves the UR5-Robot to its initial position due to the basket.</div><div class="ttdef"><b>Definition:</b> <a href="manipulator_8cpp_source.html#l00174">manipulator.cpp:174</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_a0e969f325196c09803529cb84d73f546"><div class="ttname"><a href="classRobotInitializer.html#a0e969f325196c09803529cb84d73f546">RobotInitializer::providedPorts</a></div><div class="ttdeci">static BT::PortsList providedPorts()</div><div class="ttdoc">Gets the ports provided by this behavior.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00055">robot.cpp:55</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_a69b798a1b2c0e61419663c628d3f0e99"><div class="ttname"><a href="classBatteryCheck.html#a69b798a1b2c0e61419663c628d3f0e99">BatteryCheck::node_handle_</a></div><div class="ttdeci">ros::NodeHandle node_handle_</div><div class="ttdef"><b>Definition:</b> <a href="robot_8h_source.html#l00064">robot.h:64</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_ab42e64f3b8f22906788bdbcaece448e9"><div class="ttname"><a href="classBatteryCheck.html#ab42e64f3b8f22906788bdbcaece448e9">BatteryCheck::providedPorts</a></div><div class="ttdeci">static BT::PortsList providedPorts()</div><div class="ttdoc">Ports to exchange information between each other.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00200">robot.cpp:200</a></div></div>
<div class="ttc" id="aclassManipulator_html"><div class="ttname"><a href="classManipulator.html">Manipulator</a></div><div class="ttdoc">Class which actually controls the manipulator.</div><div class="ttdef"><b>Definition:</b> <a href="manipulator_8h_source.html#l00051">manipulator.h:51</a></div></div>
<div class="ttc" id="aclassBatteryCharge_html_a851db75b08a716140c848adc3c2f5545"><div class="ttname"><a href="classBatteryCharge.html#a851db75b08a716140c848adc3c2f5545">BatteryCharge::BatteryCharge</a></div><div class="ttdeci">BatteryCharge(const std::string &amp;name, const BT::NodeConfiguration &amp;config)</div><div class="ttdoc">Construct a new Battery Check:: Battery Check object.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00221">robot.cpp:221</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_a69d05329d59f5762ba62fdfccc04e7c5"><div class="ttname"><a href="classBatteryCheck.html#a69d05329d59f5762ba62fdfccc04e7c5">BatteryCheck::BatteryCheck</a></div><div class="ttdeci">BatteryCheck(const std::string &amp;name, const BT::NodeConfiguration &amp;config)</div><div class="ttdoc">Construct a new Battery Check:: Battery Check object.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00146">robot.cpp:146</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_a30c428fcc19ac0cf1b0373196d8fb352"><div class="ttname"><a href="classRobotInitializer.html#a30c428fcc19ac0cf1b0373196d8fb352">RobotInitializer::init</a></div><div class="ttdeci">void init(ros::NodeHandle node_handle) override</div><div class="ttdoc">Set the NodeHandle reference object.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00033">robot.cpp:33</a></div></div>
<div class="ttc" id="aros__logs_8h_html_a4a4256ba66bee01b1b57fb080b148260"><div class="ttname"><a href="ros__logs_8h.html#a4a4256ba66bee01b1b57fb080b148260">ROS_LOG_INIT</a></div><div class="ttdeci">#define ROS_LOG_INIT(name)</div><div class="ttdef"><b>Definition:</b> <a href="ros__logs_8h_source.html#l00006">ros_logs.h:6</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_a1524baa7279bac051fd722437dcd91c5"><div class="ttname"><a href="classBatteryCheck.html#a1524baa7279bac051fd722437dcd91c5">BatteryCheck::init</a></div><div class="ttdeci">void init(ros::NodeHandle node_handle) override</div><div class="ttdoc">Initializes the NodeHandle reference.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00160">robot.cpp:160</a></div></div>
<div class="ttc" id="aclassBatteryCheck_html_ac79a01b11197fe856190109749dec577"><div class="ttname"><a href="classBatteryCheck.html#ac79a01b11197fe856190109749dec577">BatteryCheck::TimerCallback</a></div><div class="ttdeci">void TimerCallback(const ros::TimerEvent &amp;timer_event)</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00205">robot.cpp:205</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_ac285c050416af9a604ba00b689fc550f"><div class="ttname"><a href="classRobotInitializer.html#ac285c050416af9a604ba00b689fc550f">RobotInitializer::LaunchBasket</a></div><div class="ttdeci">void LaunchBasket()</div><div class="ttdoc">Launches the basket into gazebo and attaches it to the summit_xl robot.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00079">robot.cpp:79</a></div></div>
<div class="ttc" id="aclassRobotInitializer_html_abd7b91acbc62b21d4c316dc948cb80bf"><div class="ttname"><a href="classRobotInitializer.html#abd7b91acbc62b21d4c316dc948cb80bf">RobotInitializer::RobotInitializer</a></div><div class="ttdeci">RobotInitializer(const std::string &amp;name, const BT::NodeConfiguration &amp;config)</div><div class="ttdoc">Construct a new Robot Initializer:: Robot Initializer object.</div><div class="ttdef"><b>Definition:</b> <a href="robot_8cpp_source.html#l00013">robot.cpp:13</a></div></div>

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/tomato_harvester">tomato_harvester</a><br />
Author(s): Mirco Huber <hubermir@students.zhaw.ch>, Silas Hirschi <hirscsil@students.zhaw.ch></br />
<small>autogenerated on Fri Jun 10 2022 14:22:23</small>
</div>
</body>
</html>
